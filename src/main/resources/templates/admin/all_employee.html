<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title th:text="${title}">All Employees</title>
  <th:block th:replace="~{fragments/common_css::commonCss1}"></th:block>

  <!-- SweetAlert + Tailwind -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
    .employee-img {
      width: 100px;
      height: 100px;
      object-fit: cover;
      border-radius: 50%;
    }

    .card-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1.5rem;
    }

    .toggle-btn {
      margin-bottom: 20px;
    }
  </style>
</head>
<body>

<!-- Header -->
<div th:replace="~{fragments/adminHeader::headerFragment}"></div>

<!-- Flash message -->
<p id="mssg1" th:text="${mssg}" style="display:none"></p>
<div th:if="${mssg}">
  <script th:inline="javascript">
    Swal.fire({
      title: "Notice",
      text: /*[[${mssg}]]*/ '',
      icon: "success"
    });
  </script>
</div>

<!-- Toggle Button -->
<div class="text-center">
  <button class="btn btn-primary toggle-btn" onclick="toggleView()">Toggle View</button>
</div>

<div class="main-body px-4 py-3">

  <!-- ðŸ”„ Table View -->
  <div id="tableView">
    <h2 class="text-center text-primary mb-3">All Employees (Table View)</h2>
    <div class="table-responsive">
      <table class="table table-bordered table-hover table-striped align-middle text-center">
        <thead class="table-dark">
          <tr>
            <th>#</th>
            <th>Image</th>
            <th>Name</th>
            <th>Phone</th>
            <th>Gender</th>
            <th>Qualification</th>
            <th>Experience</th>
            <th>Emp. Type</th>
            <th>Service Type</th>
            <th>Charges</th>
            <th>Description</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <tr th:each="emp, iterStat : ${empKey}">
            <th th:text="${iterStat.count}"></th>
            <td><img th:src="@{'/' + ${emp.pic}}" class="employee-img" alt="Image"></td>
            <td th:text="${emp.name}"></td>
            <td th:text="${emp.phone}"></td>
            <td th:text="${emp.gender}"></td>
            <td th:text="${emp.qualification}"></td>
            <td th:text="${emp.experience}"></td>
            <td th:text="${emp.employee_type}"></td>
            <td th:text="${emp.service_type}"></td>
            <td th:text="'â‚¹ ' + ${emp.charges}"></td>
            <td th:text="${emp.description}"></td>
            
            <td>
              <form th:action="@{'/admin/deleteEmployee/' + ${emp.empId}}" method="post" 
                    onsubmit="return confirm('Are you sure you want to delete this employee?');">
                <button class="btn btn-danger btn-sm">Delete</button>
              </form>
              
              <a th:href="@{/admin/editEmployee(employeeId=${emp.empId})}"
               class="btn btn-success btn-sm mt-1">Edit
             </a>
            </td>
          
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- ðŸ”„ Card View (Initially hidden) -->
  <div id="cardView" style="display: none;">
    <h2 class="text-center text-success mb-4">All Employees (Card View)</h2>
    <div class="card-container">
      <div class="card border rounded-lg shadow-lg p-4 text-center bg-white text-gray-900"
           th:each="emp : ${empKey}">
           
        <img th:src="@{'/' + ${emp.pic}}" class="employee-img mx-auto mb-3" alt="Profile">
        <h5 class="text-lg font-semibold text-green-700" th:text="${emp.name}">Name</h5>
        <p><strong>Phone:</strong> <span th:text="${emp.phone}"></span></p>
        <p><strong>Gender:</strong> <span th:text="${emp.gender}"></span></p>
        <p><strong>Qualification:</strong> <span th:text="${emp.qualification}"></span></p>
        <p><strong>Experience:</strong> <span th:text="${emp.experience}"></span></p>
        <p><strong>Type:</strong> <span th:text="${emp.employee_type}"></span></p>
        <p><strong>Service:</strong> <span th:text="${emp.service_type}"></span></p>
        <p><strong>Charges:</strong> â‚¹<span th:text="${emp.charges}"></span></p>
        <p class="text-sm mt-2" th:text="${emp.description}"></p>
        <div class="flex justify-center mt-3 ">
          <form th:action="@{'/admin/deleteEmployee/' + ${emp.empId}}" method="post" 
                onsubmit="return confirm('Are you sure you want to delete this employee?');">
            <button type="submit" class="btn btn-danger btn-sm">Delete</button>
          </form>
          <a th:href="@{/admin/editEmployee(employeeId=${emp.empId})}" class="btn btn-success btn-sm" style="margin-top: 2px;">Edit</a>
        </div>
      </div>
    </div>
  </div>

</div>

<!-- Footer -->
<div th:replace="~{fragments/footer::footerFragment}"></div>

<!-- Toggle JS -->
<script>
  function toggleView() {
    const table = document.getElementById('tableView');
    const card = document.getElementById('cardView');
    table.style.display = (table.style.display === 'none') ? 'block' : 'none';
    card.style.display = (card.style.display === 'none') ? 'block' : 'none';
  }
</script>

</body>
</html>
